<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chem Academy</title>
    <script src="javascript/model3d.js"></script>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <h1 id = "title">Chem Academy</h1>
    <div id = "ptable">
        
    </div>
    <script>
    const jsondata = fetch("data/info.json").then((response) => response.json());
    let data = null;
    const maxval = 18;
    let vshellimg = {

    }
    async function load(){
        data = await jsondata;
        for(let i = 1; i <= 18; i++){
            if(i > 8 && i < 18){
                continue;
            }
            vshellimg[i] = new Image();
            vshellimg[i].src = "images/Shell" + i + ".svg";
            vshellimg[i].setAttribute("class", "shell");
            vshellimg[i].setAttribute("alt", "Shell" + i);
        }
        for(let  v of data.elements){
            await addElement(v);
        }
    }
    

    async function addElement(v){
        const element = document.createElement("div");
        element.setAttribute("class", "element");
        element.setAttribute("id", v.name);
        element.style.gridColumnStart = v.xpos;
        element.style.gridRowStart = v.ypos;
        element.innerHTML = "<p> " + v.symbol+"</p>";
        element.onclick = function(){
            let elemet = this.id;
            let elobject = data.elements.find((element) => element.name == elemet);
            popUp(elobject);
        }

        let val = v.shells[v.shells.length - 1];
        let img = vshellimg[val];
        element.appendChild(cloneImage(img));
        document.getElementById("ptable").appendChild(element);

    }
    function popUp(el){
        document.getElementById("popOut").style.display = "block";
        document.getElementById("popOut").style.zIndex = "1000";
        document.getElementById("elementNameText").innerHTML = el.name;
        document.getElementById("elementAtomicNumber").innerHTML = el.number;
        document.getElementById("elementSymbol").innerHTML = el.symbol;
        document.getElementById("elementAtomicMass").innerHTML = "Mass " + Math.round(el.atomic_mass) + " g/M";
        document.getElementById("elementAtomicDensity").innerHTML = "Density " + Math.round(el.density) + " g/cm<sup>3</sup>";
        document.getElementById("elementAtomicPhase").innerHTML = "Phase " + Math.round(el.phase);
        document.getElementById("summaryText").innerHTML = el.summary;
         document.getElementById("reallifeText").innerHTML = el.reallife;
       // document.getElementById("").innerHTML= d;
       console.log(el.bohr_model_3d);
       document.getElementById("atom_model").setAttribute("src", el.bohr_model_3d);        
    }
    function cloneImage(img){
        let i = new Image();
        i.src = img.src;
        i.setAttribute("class", "shell");
        i.setAttribute("alt", img.alt);
        return i;
    }
    load();
    </script>
    <div id="popOut" class="modal">
        <div id="elementName" class="modal">
            <h1 id="elementNameText" class="modal">Element Name</h1>
        </div>
        <div id="onTitle" class="modal">
            <div id="littleElement" class="modal">
                <span id="elementAtomicNumber" class="modal">1</span>
                <h1 id="elementSymbol" class="modal">H</h1>
            </div>
            <div id="elementInfo" class="modal">
                <span id="elementAtomicMass" class="modal">Mass: 1.008 g/M</span>
                <span id="elementAtomicDensity" class="modal">Density: 0.08988 g/L</span>
                <span id="elementAtomicPhase" class="modal">Phase: Gas</span>
            </div>
        </div>
        <model-3d background-color="#ffffff" id = "atom_model" src= "" class="modal"></model-3d>
        <div id="chatBox" class="modal">
            <p id="chatTextP" class="modal"></p>
            <div id="chatInput" class="modal">
                <label for="chatInputText"></label><input type="text" id="chatInputText" class="modal" placeholder="Type here...">
            </div>
        </div>
        <div id="summary" class="modal">
            <h1 id="summaryTitle" class="modal">Summary</h1>
            <p id="summaryText" class="modal">aemical element with atomic number 1 which means there are 1 protons and 1 electrons in the atomic structure. The chemical symbol for Hydrogen is H. With a standard atomic weight of circa 1.008, hydrogen is the lightest element on the periodic table. Its mon atomic form (H) is the most abundant chemical substance in the Universe, constituting roughly 75% of all baryon mass. Non-remnant stars are mainly composed of hydrogen in the plasma state. The most common isotope of hydrogen, termed protium (name rarely used, symbol 1H), has one proton and no neutrons.</p>
        </div>
        <div id="reallife" class="modal">
            <h1 id="reallifeTitle" class="modal">Uses</h1>
            <p id="reallifeText" class="modal">asdf </p>
        
    </div>
    
<script>
    //when press enter on chatInputText, delete the text and add the text to chatTextP
    document.getElementById("chatInputText").addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            document.getElementById("chatTextP").innerHTML = document.getElementById("chatInputText").value + "<br> <br> <br>";
            document.getElementById("chatInputText").value = "";
        }
    });
    //add event listener, if popOut is not clicked, hide it
    document.addEventListener("click", function(event) {
        if(event.target == null){
            document.getElementById("popOut").style.display = "none";
            document.getElementById("popOut").style.zIndex = "-1";
            return;
        }
        if (!event.target.classList.contains("modal") && !event.target.classList.contains("element") && !event.target.parentNode.classList.contains("element")) {
            document.getElementById("popOut").style.display = "none";
            document.getElementById("popOut").style.zIndex = "-1";
        }
    });
</script>
</body>
</html>